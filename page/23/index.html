<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My Hugo Blog</title><meta name=description content="Blog"><meta name=author content><link rel=canonical href=https://ny-a.github.io/hugo-blog/><link crossorigin=anonymous href=/hugo-blog/assets/css/stylesheet.min.35cd0f65a15cafa92372b8313deef5960aae04b90ad722f2bbf509eb0468137e.css integrity="sha256-Nc0PZaFcr6kjcrgxPe71lgquBLkK1yLyu/UJ6wRoE34=" rel="preload stylesheet" as=style><link rel=icon href=https://ny-a.github.io/hugo-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ny-a.github.io/hugo-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ny-a.github.io/hugo-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://ny-a.github.io/hugo-blog/apple-touch-icon.png><link rel=mask-icon href=https://ny-a.github.io/hugo-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><link rel=alternate type=application/rss+xml href=https://ny-a.github.io/hugo-blog/index.xml><meta property="og:title" content="My Hugo Blog"><meta property="og:description" content="Blog"><meta property="og:type" content="website"><meta property="og:url" content="https://ny-a.github.io/hugo-blog/"><meta name=twitter:card content="summary"><meta name=twitter:title content="My Hugo Blog"><meta name=twitter:description content="Blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"My Hugo Blog","url":"https://ny-a.github.io/hugo-blog/","description":"Blog","thumbnailUrl":"https://ny-a.github.io/hugo-blog/favicon.ico","sameAs":[]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ny-a.github.io/hugo-blog/ accesskey=h title="My Hugo Blog (Alt + H)">My Hugo Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://ny-a.github.io/hugo-blog/archives title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>ターミナルでEnterが^Mになってしまうときの対処法</h2></header><section class=entry-content><p>cat コマンドなどでターミナルにバイナリ(制御文字)を吐いてしまうと、 Enter キーを押しても sudo などのパスワード入力を確定できなくなることがあります。 (前使っていた xterm ではコマンドの入力もできなくなっていた気がしますが、 rxvt-unicode ではコマンドは使えるようです。)
Pressing enter produces ^M instead of a newline - Ask Ubuntu に書いてある通りですが、 stty sane (全てデフォルト値に戻す) か stty icrnl (CR を new line として扱う) を実行すれば直るようです。
これで遠慮なくバイナリを吐かせることができますね。 と思ったのですが、 Can “cat-ing” a file be a potential security risk? などを見るとセキュリティ上あまり好ましくないようですね……</p></section><footer class=entry-footer>February 6, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to ターミナルでEnterが^Mになってしまうときの対処法" href=https://ny-a.github.io/hugo-blog/posts/2020-02/stty-to-fix-enter-key/></a></article><article class=post-entry><header class=entry-header><h2>YubikeyにGPGキーを登録しました</h2></header><section class=entry-content><p>新しいGPGキーを作成しました で GPG キーを作成しましたが、 Yubikey も活用できるように Yubikey にも GPG キーを登録してみました。
マスターキーの入っている環境で新しくサブキーを作成します。 ykman piv や gpg コマンドで試した感じでは、手元の Yubikey には RSA 以外の ECDSA/EdDSA のキーを 登録することができませんでした。 (Yubikey5 NFC, Firmware 5.1.2 なのでできると思ったのですが……) そのため、 RSA 4096bit のサブキーを3種類作成します。
そして、それぞれ keytocard を実行して、 Yubikey に秘密鍵を移動します。 移動すると ssb> と表示され、 Card serial No. が表示されます(このあたりがどう保存されているか気になっています)。
あとは PIN を適宜変更するのですが、 gpg --edit-card と ykman piv で PIN の管理が別なのかはよく分かっていません。 (登録してみた感じだと別で管理されているようですが、きちんと調べられていません) gpg の PIN, Admin PIN, ykman piv の PIN, PUK に加え、 Management Key というものがありますが、 これは ykman piv change-management-key -p を実行して PIN を入力することで、 PIN から生成して PIN で認証するように することができます。...</p></section><footer class=entry-footer>February 5, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to YubikeyにGPGキーを登録しました" href=https://ny-a.github.io/hugo-blog/posts/2020-02/save-gpg-key-on-yubikey/></a></article><article class=post-entry><header class=entry-header><h2>新しいGPGキーを作成しました</h2></header><section class=entry-content><p>Yubikey もあることですし、そろそろ GPG や SSH の秘密鍵を統一しようと思います。 GPGで自分用の秘密鍵を1つに統一する を参考に進めていきました。
上記記事ではエアギャップコンピュータが推奨されていますが、今回はマスターキーのバックアップの 利便性のため、ネットワークに接続した状態で行いました。 QUBES OS はよさそうですね。 Fedora ベースなのが 少し気になるといえばそうですが……(ArchLinux に慣れているため)。
さて、普段使いの環境にはマスターキーの秘密鍵は置いておきたくないので、 マスターキーの生成は別の環境で行います。 バックアップの利便性なども考えて、 LUKS で暗号化したパーティションをファイルに保存します。
dd if=/dev/zero of=encrypted_partition.img bs=1M count=64 sudo cryptsetup luksFormat -i 5000 --use-random encrypted_partition.img # type 'YES' and set password sudo cryptsetup luksOpen encrypted_partition.img gpg_container sudo mkfs.ext4 /dev/mapper/gpg_container sudo mount /dev/mapper/gpg_container /mnt sudo mkdir /mnt/.gnupg sudo chown [current_user] /mnt/.gnupg GPG の操作は今作成した /mnt/.gnupg を GNUPGHOME に設定して行います。 必要なだけマスターキーとサブキーを作成していきます。
GNUPGHOME=/mnt/.gnupg gpg --full-gen-key 作成が終わったら、サブキーだけをエクスポートします。キーの fingerprint は gpg -K で確認できます。...</p></section><footer class=entry-footer>February 4, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to 新しいGPGキーを作成しました" href=https://ny-a.github.io/hugo-blog/posts/2020-02/create-new-gpg-key/></a></article><article class=post-entry><header class=entry-header><h2>RasPiでcryptsetup benchmarkを実行してみました</h2></header><section class=entry-content><p>タイトルの通りですが…… RaspberryPi 3B+ で cryptsetup benchmark を実行してみました。
$ cryptsetup benchmark # Tests are approximate using memory only (no storage IO). PBKDF2-sha1 206738 iterations per second for 256-bit key PBKDF2-sha256 316599 iterations per second for 256-bit key PBKDF2-sha512 200415 iterations per second for 256-bit key PBKDF2-ripemd160 174529 iterations per second for 256-bit key PBKDF2-whirlpool 29153 iterations per second for 256-bit key argon2i 4 iterations, 172077 memory, 4 parallel threads (CPUs) for 256-bit key (requested 2000 ms time) argon2id 4 iterations, 177813 memory, 4 parallel threads (CPUs) for 256-bit key (requested 2000 ms time) # Algorithm | Key | Encryption | Decryption aes-cbc 128b 28....</p></section><footer class=entry-footer>February 3, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to RasPiでcryptsetup benchmarkを実行してみました" href=https://ny-a.github.io/hugo-blog/posts/2020-02/cryptsetup-benchmark-on-raspi/></a></article><article class=post-entry><header class=entry-header><h2>Yubikeyのファームウェア5.2.3がリリースされていました</h2></header><section class=entry-content><p>Yubikey を持っていますが、現在はあまり活用できていません。 その理由の1つに、普段使っている ed25519 なキーに Yubikey が対応していないことがあります。
今日ふとそのことについてもう一度調べていたら、 What’s New in YubiKey Firmware 5.2.3 というブログ記事を見つけました。 知らない間に ed25519 にも対応していたようです。 とはいえ、そのためだけに Yubikey を新調するのも気が進まないので、しばらくの間は NIST P-384 や RSA-4096 を使おうと思います。
エアギャップコンピュータを使って GPG の primary key の管理などをしようと思いつつなかなかできていないのですが、 キーのバックアップのことなどを考えて悩んでいます。紙に印刷する/光学メディアに書き込むなどの方法が一般的(？)な ようですが、紙や光学メディアも耐久性に不安があります。 金属板にレーザーで QR コードを印刷できれば……とは思いますが、さすがにコストがかかりすぎるので……</p></section><footer class=entry-footer>February 2, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to Yubikeyのファームウェア5.2.3がリリースされていました" href=https://ny-a.github.io/hugo-blog/posts/2020-02/yubikey-firmware-5-2-3/></a></article><article class=post-entry><header class=entry-header><h2>6gramを使ってみました</h2></header><section class=entry-content><p>mixi の新しいアプリの 6gram というアプリを使ってみました。 サービス内容はおおまかには kyash と似ていると言えますが、 グループでお金を出し合うことができる、インスタントカードを30枚まで発行できる、 発行カードがJCBプリペイドである、といった違いがあります。
リアルカードは後日受付開始ということなので、現在はバーチャルカードでのオンライン決済と QUICPay を使用した実店舗での決済が可能なようです。 QUICPay の決済速度は、一度試した感じだと kyash の高速化後のイメージが近いかなと思いました。
アカウント登録時に発行されるバーチャルカードにはグループのカードを紐付けることができ、 紐付けると QUICPay で決済が可能になります。 任意に発行できるインスタントカードは紐付けることはできず、オンライン決済専用なようです。 考えてみれば QUICPay での支払い用にインスタントカードを発行する必要はありませんが…… 食費など Wallet を分ける用途で使えると思っていたので少し期待外れではありました。
また、インスタントカードやグループカードには100円単位でお金を出し入れすることが できます。グループの説明に「自由に出し入れ」「割り勘不要」とあるように、 グループメンバー全員が自発的に入金して大まかに出し合うような仲のいいメンバーでの 使用がターゲットなように感じます。
2月に入る前に iPhone 版もリリースされたので、気軽に勧められるようになりました。 公式の招待も割と早く届くようなので、気軽に招待リクエストを送ってみたらよさそうです。</p></section><footer class=entry-footer>February 1, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to 6gramを使ってみました" href=https://ny-a.github.io/hugo-blog/posts/2020-02/6gram-app/></a></article><article class=post-entry><header class=entry-header><h2>GitHubActionsでGridsomeのブログのビルドを設定しました</h2></header><section class=entry-content><p>昨日に続いて Gridsome のブログのビルドも自動化しました。
やっていることはほとんど Gatsby の場合と同じなので、設定ファイルを追加するだけです。
Jekyll のブログのビルドも一緒にやってしまおうと思っていたのですが、Jekyll のサブディレクトリの扱いが Gatsby/Gridsome と違っていたので一旦後回しにしようと思います。 現状ほぼ画像等使っていないので、Jekyll の想定するディレクトリ構造にしてしまってもいいのですが、 現状の方が好ましいような気がするので、方法を考えてみようと思っています。</p></section><footer class=entry-footer>January 31, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to GitHubActionsでGridsomeのブログのビルドを設定しました" href=https://ny-a.github.io/hugo-blog/posts/2020-01/config-gridsome-cd/></a></article><article class=post-entry><header class=entry-header><h2>GitHubActionsを使ってデプロイを自動化しました</h2></header><section class=entry-content><p>先日はブログのコンテンツと Gatsby のテンプレートを分離しましたが、 コンテンツを push すると CI/CD で自動でビルド・デプロイまでできるようにしました。
ビルド環境は Gatsby の方のレポジトリですが、 push でトリガーされるのはコンテンツのレポジトリなため、 GitHub のフォーラム を参考に、コンテンツのレポジトリに push されたときに Gatsby のレポジトリのビルドをトリガーするようにしました。
この調子で Gridsome と Jekyll もビルド・デプロイを自動化して、デザインを統一しようと思います。 3つもデプロイする必要はないですが……。</p></section><footer class=entry-footer>January 30, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to GitHubActionsを使ってデプロイを自動化しました" href=https://ny-a.github.io/hugo-blog/posts/2020-01/config-continuous-delivery/></a></article><article class=post-entry><header class=entry-header><h2>Blogの内容を別レポジトリに移動しました</h2></header><section class=entry-content><p>今までは gatsby のブログ用レポジトリにブログの内容を追加していましたが、 テンプレートと内容は分けた方がいいかなと思い、内容だけ別レポジトリに分けてみました。
具体的には、 gatsby-source-filesystem を使っていたのを gatsby-source-git に変更しました。 基本的に gatsby-source-filesystem と同様に使えると書いてありましたが、 slug の生成に createFilePath を使っていたのが gatsby-source-filesystem に依存していたので、 node.parent.file.relativeDirectory から生成するように変更しました。
また、 gatsby-source-git の指定だけだと、タイミングの問題なのか gatsby-transformer-remark あたりで 問題が発生していたので、 gatsby-source-filesystem でダミーのソースを指定することでとりあえず対処しました。
レポジトリを分離したので CI を使ってビルドするようにしようかなと思ったのですが、そうすると 別に gatsby-source-git を使わなくても、 CI 側で事前に checkout しておけばいいのでは……と思ってきました。 また戻すかもしれません。</p></section><footer class=entry-footer>January 29, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to Blogの内容を別レポジトリに移動しました" href=https://ny-a.github.io/hugo-blog/posts/2020-01/move-blog-contents-to-another-repo/></a></article><article class=post-entry><header class=entry-header><h2>grpc-nodeのビルドに失敗する</h2></header><section class=entry-content><p>npm install grpc build from source fails に書いてある通りなのですが……。
node v13 ではソースからのビルドになってインストールに失敗します。 node v10 を使えばバイナリパッケージがあるようです。
nvm をインストールしてとりあえずの対処をしようと思います。</p></section><footer class=entry-footer>January 28, 2020&nbsp;·&nbsp;1 分</footer><a class=entry-link aria-label="post link to grpc-nodeのビルドに失敗する" href=https://ny-a.github.io/hugo-blog/posts/2020-01/can-not-build-grpc-node/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://ny-a.github.io/hugo-blog/page/22/>« 前のページ</a>
<a class=next href=https://ny-a.github.io/hugo-blog/page/24/>次のページ »</a></nav></footer></main><footer class=footer><span>&copy; 2021 <a href=https://ny-a.github.io/hugo-blog/>My Hugo Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>